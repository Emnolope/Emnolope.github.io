<!DOCTYPE html>
<html>
<head>
<title>Demo - Capture Photo From Webcam Using Javascript</title>
<meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
#start-camera {
    margin-top: 50px;
}

#video {
    display: none;
    width: 100%;
}

#click-photo {
    display: none;
}

#dataurl-container {
    display: none;
}

#canvas {
    display: block;
    width: 100%;
}

#dataurl-header {
    text-align: center;
    font-size: 15px;
}

#fileName{
    display: none;
    width: 30%;
}
#downloadID{
    display: none;
}

#resetBtn{
    margin: 10px 20px 0px 20px;
    display: none;
}
  </style>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</head>
<body>
    <div class="container p-3 my-3">
        <div class="row">
            <h3>Capture Photo using JavaScript Web API</h3>    
            <button class="btn btn-primary" id="start-camera"><i class="fas fa-camera"></i> Start Camera</button>
        </div>
        <div class="row align-items-center">
            <div class="col-lg-5">
                <video id="video" autoplay></video>
            </div>
            <div class="col-lg-2 justify-content-center">
                <button class="btn btn-primary" id="click-photo"><i class="fas fa-camera-retro"></i> Click Photo </button>
                <button class="btn btn-secondary" id="resetBtn"><i class="fas fa-sync-alt"></i> Reset </button>
            </div>
            <div class="col-lg-5" id="dataurl-container">
                <canvas id="canvas" width="420" height="240"></canvas>
            </div>
        </div>  
        <div class="row justify-content-end p-3" id="downloadDIV">
            <input class="form-control" type="text" id="fileName" placeholder="Enter File Name">
            <a class="btn btn-link" id="downloadID">Download</a>
        </div>      
    </div>
    <script>
let camera_button = document.querySelector("#start-camera");
let video = document.querySelector("#video");
let click_button = document.querySelector("#click-photo");
let canvas = document.querySelector("#canvas");
let dataurl_container = document.querySelector("#dataurl-container");
let downloadBtn = document.querySelector("#downloadID");
let resetBtn = document.querySelector("#resetBtn");
let fileName = document.querySelector("#fileName");

camera_button.addEventListener('click', async function() {
   	let stream = null;
    try {
    	stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: false });
    }
    catch(error) {
    	alert(error.message);
    	return;
    }
    video.srcObject = stream;
    video.style.display = 'block';
    camera_button.style.display = 'none';
    click_button.style.display = 'block';
});

click_button.addEventListener('click', function() {
    canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);
   	let image_data_url = canvas.toDataURL('image/jpeg');
	downloadBtn.href = image_data_url;
    dataurl_container.style.display = 'block';
    downloadBtn.style.display = 'block';
    fileName.style.display = 'block';
    resetBtn.style.display = 'block';
});

fileName.addEventListener('keyup', function() {    
    downloadBtn.download = fileName.value + '.jpeg';
});

resetBtn.addEventListener('click', function() {    
    dataurl_container.style.display = 'none';
    downloadBtn.download = '';
    downloadBtn.style.display = 'none';
    resetBtn.style.display = 'none';
    fileName.value = '';
    fileName.style.display = 'none';
});
    </script>
</body>
</html>
